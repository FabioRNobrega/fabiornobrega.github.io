<div class="lang-switcher" aria-label="{{ locale_strings.language_selector }}">
    {% for locale in site.locales %}
    {% assign label = locale[0] %}
    {% assign locale_object = locale[1] %}
    <div lang="{{ locale_object.lang }}">
      {% if label == page.locale %}
      <a class="lang-switcher__flag" href="{{ page.url | prepend: site.baseurl }}" aria-current="true">{{ locale_object.name }}</a>
      {% else %}
        {% assign localized_page = localized_pages | where: "locale", label | first %}
        {% if localized_page %}
        <a href="{{ localized_page.url | prepend: site.baseurl }}" hreflang="{{ locale_object.lang }}">
          <span class="lang-switcher__flag"> {{ locale_object.name }} </span>
        </a>
        {% else %}
        <a href="{{ locale_object.baseurl | prepend: site.baseurl }}/" hreflang="{{ locale_object.lang }}" class="not-available">
          <span class="lang-switcher__flag"> {{ locale_object.name }} </span> 
        </a>
        {% endif %}
      {% endif %}
    </div>
    {% endfor %}
</div>
